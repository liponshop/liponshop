<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout - LiponShop</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
--primary: #4f46e5;
--primary-dark: #4338ca;
--secondary: #f59e0b;
--success: #10b981;
--danger: #ef4444;
--dark: #1f2937;
--light: #f9fafb;
--white: #ffffff;
--gray: #6b7280;
--border: #e5e7eb;
}
* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Poppins', 'Hind Siliguri', sans-serif;
}
body {
background: var(--light);
color: var(--dark);
line-height: 1.6;
padding-bottom: 30px;
}
.checkout-header {
background: var(--white);
padding: 20px 0;
box-shadow: 0 2px 10px rgba(0,0,0,0.05);
position: sticky;
top: 0;
z-index: 100;
}
.header-content {
max-width: 1200px;
margin: 0 auto;
padding: 0 15px;
display: flex;
justify-content: space-between;
align-items: center;
}
.logo {
font-size: 24px;
font-weight: 700;
color: var(--primary);
text-decoration: none;
}
.back-link {
color: var(--gray);
text-decoration: none;
display: flex;
align-items: center;
gap: 8px;
font-weight: 500;
transition: 0.3s;
}
.back-link:hover {
color: var(--primary);
}
.checkout-container {
max-width: 1200px;
margin: 30px auto;
padding: 0 15px;
display: grid;
grid-template-columns: 1.5fr 1fr;
gap: 25px;
}
.form-section {
background: var(--white);
padding: 25px;
border-radius: 12px;
box-shadow: 0 2px 12px rgba(0,0,0,0.06);
margin-bottom: 20px;
}
.section-title {
font-size: 18px;
font-weight: 600;
margin-bottom: 20px;
padding-bottom: 12px;
border-bottom: 2px solid var(--light);
display: flex;
align-items: center;
gap: 10px;
}
.section-title i {
color: var(--primary);
}
.form-grid {
display: grid;
grid-template-columns: repeat(2, 1fr);
gap: 15px;
}
.form-group {
display: flex;
flex-direction: column;
gap: 6px;
}
.form-group.full-width {
grid-column: 1 / -1;
}
.form-group label {
font-size: 14px;
font-weight: 500;
color: var(--dark);
}
.form-group input,
.form-group textarea,
.form-group select {
padding: 12px 15px;
border: 2px solid var(--border);
border-radius: 10px;
font-size: 14px;
transition: all 0.3s;
}
.form-group input:focus,
.form-group textarea:focus,
.form-group select:focus {
border-color: var(--primary);
outline: none;
box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
}
.form-group textarea {
min-height: 100px;
resize: vertical;
}
.form-hint {
font-size: 12px;
color: var(--gray);
}
/* Guest Checkout Toggle */
.guest-checkout-toggle {
display: flex;
align-items: center;
gap: 10px;
margin-bottom: 20px;
padding: 15px;
background: #eef2ff;
border-radius: 10px;
}
.guest-checkout-toggle input {
width: 20px;
height: 20px;
}
/* Delivery Options */
.delivery-options {
display: flex;
flex-direction: column;
gap: 12px;
}
.delivery-option {
display: flex;
align-items: center;
gap: 12px;
padding: 15px;
border: 2px solid var(--border);
border-radius: 10px;
cursor: pointer;
transition: all 0.3s;
}
.delivery-option:hover,
.delivery-option.selected {
border-color: var(--primary);
background: #eef2ff;
}
.delivery-option input {
width: 18px;
height: 18px;
cursor: pointer;
}
.delivery-option label {
flex: 1;
cursor: pointer;
display: flex;
align-items: center;
gap: 10px;
font-weight: 500;
}
.delivery-option i {
font-size: 20px;
width: 24px;
text-align: center;
}
.delivery-option.express i {
color: var(--danger);
}
.delivery-option.regular i {
color: var(--success);
}
/* Payment Methods */
.payment-methods {
display: flex;
flex-direction: column;
gap: 12px;
}
.payment-option {
display: flex;
align-items: center;
gap: 12px;
padding: 15px;
border: 2px solid var(--border);
border-radius: 10px;
cursor: pointer;
transition: all 0.3s;
}
.payment-option:hover,
.payment-option.selected {
border-color: var(--primary);
background: #eef2ff;
}
.payment-option input {
width: 18px;
height: 18px;
cursor: pointer;
}
.payment-option label {
flex: 1;
cursor: pointer;
display: flex;
align-items: center;
gap: 10px;
font-weight: 500;
}
.payment-option i {
font-size: 20px;
width: 24px;
text-align: center;
}
.payment-option.bkash i {
color: #e2136e;
}
.payment-option.cod i {
color: var(--success);
}
.payment-details {
margin-top: 15px;
padding: 15px;
background: var(--light);
border-radius: 8px;
display: none;
}
.payment-details.show {
display: block;
}
.payment-details p {
margin: 8px 0;
font-size: 14px;
color: var(--gray);
}
.payment-details strong {
color: var(--dark);
}
.payment-details code {
background: var(--white);
padding: 4px 8px;
border-radius: 4px;
font-family: monospace;
color: var(--primary);
}
/* Coupon Code */
.coupon-section {
margin: 20px 0;
padding: 15px;
background: #f0fdf4;
border: 2px dashed var(--success);
border-radius: 10px;
}
.coupon-input-group {
display: flex;
gap: 10px;
}
.coupon-input-group input {
flex: 1;
padding: 12px 15px;
border: 2px solid var(--border);
border-radius: 10px;
font-size: 14px;
}
.coupon-input-group button {
padding: 12px 25px;
background: var(--success);
color: white;
border: none;
border-radius: 10px;
font-weight: 600;
cursor: pointer;
transition: all 0.3s;
}
.coupon-input-group button:hover {
background: #059669;
transform: translateY(-2px);
}
.coupon-message {
margin-top: 10px;
font-size: 14px;
font-weight: 500;
}
.coupon-message.success {
color: var(--success);
}
.coupon-message.error {
color: var(--danger);
}
/* Eyeglass Customization */
.eyeglass-customization {
margin-top: 20px;
padding: 20px;
background: #f8fafc;
border-radius: 10px;
border-left: 4px solid var(--primary);
}
.eyeglass-customization h4 {
margin-bottom: 15px;
color: var(--primary);
display: flex;
align-items: center;
gap: 8px;
}
.prescription-upload {
margin: 15px 0;
}
.prescription-upload input[type="file"] {
width: 100%;
padding: 10px;
border: 2px dashed var(--border);
border-radius: 10px;
cursor: pointer;
}
.frame-size-selector,
.lens-type-selector {
display: flex;
gap: 10px;
margin: 10px 0;
}
.size-option,
.lens-option {
flex: 1;
padding: 10px;
border: 2px solid var(--border);
border-radius: 8px;
text-align: center;
cursor: pointer;
transition: all 0.3s;
font-size: 14px;
font-weight: 500;
}
.size-option:hover,
.size-option.selected,
.lens-option:hover,
.lens-option.selected {
border-color: var(--primary);
background: #eef2ff;
color: var(--primary);
}
.addon-options {
display: grid;
grid-template-columns: repeat(2, 1fr);
gap: 10px;
margin: 15px 0;
}
.addon-option {
display: flex;
align-items: center;
gap: 8px;
padding: 10px;
border: 2px solid var(--border);
border-radius: 8px;
cursor: pointer;
transition: all 0.3s;
font-size: 13px;
}
.addon-option:hover,
.addon-option.selected {
border-color: var(--primary);
background: #eef2ff;
}
.addon-option input {
width: 16px;
height: 16px;
}
/* Order Summary */
.order-summary {
background: var(--white);
padding: 25px;
border-radius: 12px;
box-shadow: 0 2px 12px rgba(0,0,0,0.06);
height: fit-content;
position: sticky;
top: 100px;
}
.summary-title {
font-size: 18px;
font-weight: 600;
margin-bottom: 20px;
padding-bottom: 12px;
border-bottom: 2px solid var(--light);
}
.cart-items {
display: flex;
flex-direction: column;
gap: 15px;
max-height: 300px;
overflow-y: auto;
padding-right: 5px;
margin-bottom: 20px;
}
.cart-item {
display: flex;
gap: 12px;
padding-bottom: 15px;
border-bottom: 1px solid var(--border);
}
.cart-item:last-child {
border-bottom: none;
padding-bottom: 0;
}
.cart-item img {
width: 60px;
height: 60px;
object-fit: cover;
border-radius: 8px;
background: var(--light);
}
.cart-item-info {
flex: 1;
}
.cart-item-name {
font-weight: 500;
font-size: 14px;
margin-bottom: 5px;
}
.cart-item-price {
font-size: 13px;
color: var(--gray);
}
.cart-item-qty {
font-size: 12px;
color: var(--gray);
}
.summary-row {
display: flex;
justify-content: space-between;
padding: 10px 0;
font-size: 14px;
color: var(--gray);
}
.summary-row.total {
border-top: 2px solid var(--border);
margin-top: 10px;
padding-top: 15px;
font-size: 18px;
font-weight: 700;
color: var(--dark);
}
.summary-row.total span {
color: var(--primary);
}
.delivery-note {
background: #eef2ff;
padding: 12px;
border-radius: 8px;
margin: 15px 0;
font-size: 13px;
color: var(--primary);
display: flex;
align-items: center;
gap: 8px;
}
.place-order-btn {
width: 100%;
padding: 15px;
background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
color: white;
border: none;
border-radius: 10px;
font-size: 16px;
font-weight: 700;
cursor: pointer;
margin-top: 20px;
display: flex;
align-items: center;
justify-content: center;
gap: 10px;
transition: all 0.3s;
}
.place-order-btn:hover {
transform: translateY(-2px);
box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
}
.place-order-btn:disabled {
background: #9ca3af;
cursor: not-allowed;
transform: none;
}
.security-badges {
display: flex;
justify-content: center;
gap: 15px;
margin-top: 20px;
padding-top: 20px;
border-top: 1px solid var(--border);
}
.security-badges i {
font-size: 20px;
color: var(--success);
}
.security-badges span {
font-size: 12px;
color: var(--gray);
}
/* Success Modal */
.modal {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0,0,0,0.7);
z-index: 2000;
align-items: center;
justify-content: center;
animation: fadeIn 0.3s ease;
}
.modal.show {
display: flex;
}
.modal-content {
background: white;
padding: 40px;
border-radius: 20px;
max-width: 450px;
width: 90%;
text-align: center;
animation: slideUp 0.4s ease;
box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}
.modal-icon {
width: 80px;
height: 80px;
background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
margin: 0 auto 20px;
font-size: 40px;
color: white;
animation: scaleIn 0.5s ease;
}
@keyframes scaleIn {
0% {
transform: scale(0);
}
50% {
transform: scale(1.2);
}
100% {
transform: scale(1);
}
}
.modal h3 {
font-size: 24px;
color: var(--dark);
margin-bottom: 10px;
}
.modal p {
margin: 10px 0;
color: var(--gray);
font-size: 14px;
}
.modal .order-id {
background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
color: white;
padding: 15px;
border-radius: 10px;
font-weight: 700;
margin: 20px 0;
font-size: 18px;
}
.modal-btn {
background: var(--primary);
color: white;
border: none;
padding: 15px 40px;
border-radius: 10px;
font-weight: 600;
cursor: pointer;
margin-top: 20px;
transition: all 0.3s;
}
.modal-btn:hover {
background: var(--primary-dark);
transform: translateY(-2px);
}
@keyframes fadeIn {
from {
opacity: 0;
}
to {
opacity: 1;
}
}
@keyframes slideUp {
from {
opacity: 0;
transform: translateY(30px);
}
to {
opacity: 1;
transform: translateY(0);
}
}
@media (max-width: 900px) {
.checkout-container {
grid-template-columns: 1fr;
}
.order-summary {
position: static;
}
.form-grid {
grid-template-columns: 1fr;
}
}
@media (max-width: 480px) {
.checkout-header {
padding: 15px 0;
}
.form-section {
padding: 20px;
}
.place-order-btn {
padding: 12px;
font-size: 14px;
}
.coupon-input-group {
flex-direction: column;
}
.size-option,
.lens-option {
font-size: 12px;
padding: 8px;
}
}
</style>
</head>
<body>

<!-- Header -->
<div class="checkout-header">
<div class="header-content">
<a href="index.html" class="logo">
<i class="fas fa-shopping-bag"></i> LiponShop
</a>
<a href="cart.html" class="back-link">
<i class="fas fa-arrow-left"></i> ‡¶ï‡¶æ‡¶∞‡ßç‡¶ü‡ßá ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®
</a>
</div>
</div>

<!-- Main Content -->
<div class="checkout-container">
<div class="checkout-forms">

<!-- Guest Checkout Toggle -->
<div class="form-section">
<div class="guest-checkout-toggle">
<input type="checkbox" id="guestCheckout" onchange="toggleGuestCheckout()">
<label for="guestCheckout">
<strong>‡¶ó‡ßá‡¶∏‡ßç‡¶ü ‡¶ö‡ßá‡¶ï‡¶Ü‡¶â‡¶ü</strong> (‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶õ‡¶æ‡¶°‡¶º‡¶æ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®)
</label>
</div>
</div>

<!-- Customer Information -->
<div class="form-section">
<h3 class="section-title">
<i class="fas fa-user"></i> ‡¶ó‡ßç‡¶∞‡¶æ‡¶π‡¶ï‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø
</h3>
<div class="form-grid">
<div class="form-group full-width">
<label>‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶æ‡¶Æ *</label>
<input type="text" id="custName" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" required>
</div>
<div class="form-group">
<label>‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ *</label>
<input type="tel" id="custPhone" placeholder="017XXXXXXXX" pattern="01[3-9][0-9]{8}" required>
<span class="form-hint">‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü: 01712345678</span>
</div>
<div class="form-group">
<label>‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ</label>
<input type="email" id="custEmail" placeholder="your@email.com">
</div>
<div class="form-group full-width">
<label>‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ (‡¶¨‡¶æ‡¶°‡¶º‡¶ø/‡¶∞‡ßã‡¶°) *</label>
<textarea id="custAddress" placeholder="‡¶¨‡¶æ‡¶°‡¶º‡¶ø ‡¶®‡¶Ç, ‡¶∞‡ßã‡¶° ‡¶®‡¶Ç, ‡¶¨‡ßç‡¶≤‡¶ï/‡¶∏‡ßá‡¶ï‡ßç‡¶ü‡¶∞" required></textarea>
</div>

<!-- District -->
<div class="form-group">
<label>‡¶ú‡ßá‡¶≤‡¶æ *</label>
<select id="custDistrict" required onchange="loadThanas()">
<option value="">‡¶ú‡ßá‡¶≤‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
<option value="‡¶¢‡¶æ‡¶ï‡¶æ">‡¶¢‡¶æ‡¶ï‡¶æ</option>
<option value="‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ">‡¶ö‡¶ü‡ßç‡¶ü‡¶ó‡ßç‡¶∞‡¶æ‡¶Æ</option>
<option value="‡¶ó‡¶æ‡¶á‡¶¨‡¶æ‡¶®‡ßç‡¶ß‡¶æ">‡¶ó‡¶æ‡¶á‡¶¨‡¶æ‡¶®‡ßç‡¶ß‡¶æ</option>
<!-- ‡¶¨‡¶æ‡¶ï‡¶ø ‡¶ú‡ßá‡¶≤‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã locations.js ‡¶•‡ßá‡¶ï‡ßá ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá -->
</select>
</div>

<!-- Thana/Upazila -->
<div class="form-group">
<label>‡¶•‡¶æ‡¶®‡¶æ/‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ *</label>
<select id="custThana" required onchange="loadUnions()">
<option value="">‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶ú‡ßá‡¶≤‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
</select>
</div>

<!-- Union/Area -->
<div class="form-group">
<label>‡¶á‡¶â‡¶®‡¶ø‡¶Ø‡¶º‡¶®/‡¶è‡¶≤‡¶æ‡¶ï‡¶æ *</label>
<select id="custUnion" required>
<option value="">‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡ßá ‡¶•‡¶æ‡¶®‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</option>
</select>
</div>

<div class="form-group">
<label>‡¶™‡ßã‡¶∏‡ßç‡¶ü‡¶æ‡¶≤ ‡¶ï‡ßã‡¶°</label>
<input type="text" id="custPostal" placeholder="1200">
</div>
</div>
</div>

<!-- Delivery Options -->
<div class="form-section">
<h3 class="section-title">
<i class="fas fa-truck"></i> ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶Ö‡¶™‡¶∂‡¶®
</h3>
<div class="delivery-options">
<label class="delivery-option regular selected">
<input type="radio" name="delivery" value="regular" checked onchange="updateDeliveryCharge()">
<i class="fas fa-shipping-fast"></i>
<div>
<div>‡¶∞‡ßá‡¶ó‡ßÅ‡¶≤‡¶æ‡¶∞ ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø</div>
<div style="font-size: 12px; color: var(--gray);">‡ß©-‡ß´ ‡¶ï‡¶∞‡ßç‡¶Æ‡¶¶‡¶ø‡¶¨‡¶∏</div>
</div>
<div style="font-weight: 600;">‡ß≥60</div>
</label>

<label class="delivery-option express">
<input type="radio" name="delivery" value="express" onchange="updateDeliveryCharge()">
<i class="fas fa-rocket"></i>
<div>
<div>‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßç‡¶∞‡ßá‡¶∏ ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø</div>
<div style="font-size: 12px; color: var(--gray);">‡ßß-‡ß® ‡¶ï‡¶∞‡ßç‡¶Æ‡¶¶‡¶ø‡¶¨‡¶∏</div>
</div>
<div style="font-weight: 600; color: var(--danger);">‡ß≥110</div>
</label>
</div>

<!-- SMS/WhatsApp Notification -->
<div style="margin-top: 15px; padding: 15px; background: #f0fdf4; border-radius: 10px;">
<label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
<input type="checkbox" id="smsNotification" checked>
<span><i class="fas fa-bell" style="color: var(--success);"></i> ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶® ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç (SMS/WhatsApp ‡¶®‡ßã‡¶ü‡¶ø‡¶´‡¶ø‡¶ï‡ßá‡¶∂‡¶®)</span>
</label>
<p style="font-size: 12px; color: var(--gray); margin-top: 8px;">
‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ‡ßá‡¶∂‡¶® ‡¶è‡¶¨‡¶Ç ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü SMS/WhatsApp ‡¶è ‡¶™‡¶æ‡¶¨‡ßá‡¶®
</p>
</div>
</div>

<!-- Coupon Code -->
<div class="form-section">
<h3 class="section-title">
<i class="fas fa-tag"></i> ‡¶ï‡ßÅ‡¶™‡¶® ‡¶ï‡ßã‡¶°
</h3>
<div class="coupon-section">
<div class="coupon-input-group">
<input type="text" id="couponCode" placeholder="‡¶ï‡ßÅ‡¶™‡¶® ‡¶ï‡ßã‡¶° ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® (‡¶Ø‡ßá‡¶Æ‡¶®: LIPON20)">
<button onclick="applyCoupon()">‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®</button>
</div>
<div id="couponMessage" class="coupon-message"></div>
</div>
</div>

<!-- Eyeglass Customization (If product is eyeglass) -->
<div class="form-section" id="eyeglassSection" style="display: none;">
<h3 class="section-title">
<i class="fas fa-glasses"></i> ‡¶ö‡¶∂‡¶Æ‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ‡¶æ‡¶á‡¶ú‡ßá‡¶∂‡¶®
</h3>

<!-- Prescription Upload -->
<div class="prescription-upload">
<label><strong>‡¶ö‡ßã‡¶ñ‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡ßá‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡¶∂‡¶® ‡¶Ü‡¶™‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡ßÅ‡¶®</strong></label>
<input type="file" id="prescriptionFile" accept="image/*,.pdf" onchange="handlePrescriptionUpload()">
<span class="form-hint">JPG, PNG ‡¶¨‡¶æ PDF ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü (‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö 5MB)</span>
</div>

<!-- Frame Size -->
<div>
<label><strong>‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶∏‡¶æ‡¶á‡¶ú ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</strong></label>
<div class="frame-size-selector">
<div class="size-option" onclick="selectFrameSize('S', this)">S (Small)</div>
<div class="size-option" onclick="selectFrameSize('M', this)">M (Medium)</div>
<div class="size-option" onclick="selectFrameSize('L', this)">L (Large)</div>
<div class="size-option" onclick="selectFrameSize('XL', this)">XL (Extra Large)</div>
</div>
</div>

<!-- Lens Type -->
<div>
<label><strong>‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶ü‡¶æ‡¶á‡¶™ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</strong></label>
<div class="lens-type-selector">
<div class="lens-option" onclick="selectLensType('Single Vision', this)">Single Vision</div>
<div class="lens-option" onclick="selectLensType('Bifocal', this)">Bifocal</div>
<div class="lens-option" onclick="selectLensType('Progressive', this)">Progressive</div>
</div>
</div>

<!-- Add-on Options -->
<div>
<label><strong>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°-‡¶Ö‡¶® ‡¶Ö‡¶™‡¶∂‡¶®</strong></label>
<div class="addon-options">
<label class="addon-option">
<input type="checkbox" value="anti-glare" onchange="updateAddons()">
<span>Anti-Glare Coating (+‡ß≥200)</span>
</label>
<label class="addon-option">
<input type="checkbox" value="blue-cut" onchange="updateAddons()">
<span>Blue Cut Filter (+‡ß≥300)</span>
</label>
<label class="addon-option">
<input type="checkbox" value="photochromic" onchange="updateAddons()">
<span>Photochromic (+‡ß≥500)</span>
</label>
<label class="addon-option">
<input type="checkbox" value="scratch-resistant" onchange="updateAddons()">
<span>Scratch Resistant (+‡ß≥150)</span>
</label>
</div>
</div>
</div>

<!-- Payment Method -->
<div class="form-section">
<h3 class="section-title">
<i class="fas fa-credit-card"></i> ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡¶¶‡ßç‡¶ß‡¶§‡¶ø
</h3>
<div class="payment-methods">
<label class="payment-option cod selected">
<input type="radio" name="payment" value="cod" checked>
<i class="fas fa-money-bill-wave"></i>
<span>‡¶ï‡ßç‡¶Ø‡¶æ‡¶∂ ‡¶Ö‡¶® ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø</span>
</label>
<label class="payment-option bkash">
<input type="radio" name="payment" value="bkash">
<i class="fas fa-mobile-alt"></i>
<span>bKash</span>
</label>
<div class="payment-details" id="bkashDetails">
<p><strong>‡¶™‡¶æ‡¶†‡¶æ‡¶® ‡¶è‡¶á ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞‡ßá:</strong> <code>01748048267</code></p>
<p><strong>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶ü‡¶æ‡¶á‡¶™:</strong> ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤</p>
<p><strong>‡¶∞‡ßá‡¶´‡¶æ‡¶∞‡ßá‡¶®‡ßç‡¶∏:</strong> LiponShop</p>
<div class="form-group" style="margin-top:10px;">
<label>‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶® ‡¶Ü‡¶á‡¶°‡¶ø *</label>
<input type="text" id="bkashTrx" placeholder="10 ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡ßá‡¶∞ TrxID ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
</div>
</div>
</div>
</div>

<!-- Order Notes -->
<div class="form-section">
<h3 class="section-title">
<i class="fas fa-sticky-note"></i> ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶®‡ßã‡¶ü (‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï)
</h3>
<div class="form-group">
<textarea id="orderNotes" placeholder="‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶®‡¶æ?"></textarea>
</div>
</div>

</div>

<!-- Order Summary -->
<div class="order-summary">
<h3 class="summary-title">
<i class="fas fa-receipt"></i> ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂
</h3>
<div class="cart-items" id="checkoutItems"></div>

<div class="summary-row">
<span>‡¶∏‡¶æ‡¶¨‡¶ü‡ßã‡¶ü‡¶æ‡¶≤</span>
<span id="summarySubtotal">‡ß≥0</span>
</div>
<div class="summary-row">
<span>‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø ‡¶ö‡¶æ‡¶∞‡ßç‡¶ú</span>
<span id="summaryDelivery">‡ß≥60</span>
</div>
<div class="summary-row" id="addonRow" style="display: none;">
<span>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°-‡¶Ö‡¶®</span>
<span id="summaryAddons">‡ß≥0</span>
</div>
<div class="summary-row" id="discountRow" style="display: none;">
<span>‡¶°‡¶ø‡¶∏‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü</span>
<span id="summaryDiscount">-‡ß≥0</span>
</div>
<div class="summary-row total">
<span>‡¶Æ‡ßã‡¶ü</span>
<span>‡ß≥<span id="summaryTotal">0</span></span>
</div>

<div class="delivery-note">
<i class="fas fa-truck"></i> ‡¶ó‡¶æ‡¶á‡¶¨‡¶æ‡¶®‡ßç‡¶ß‡¶æ‡¶∞ ‡¶≠‡ßá‡¶§‡¶∞‡ßá ‡ß≥1000 ‡¶è‡¶∞ ‡¶â‡¶™‡¶∞‡ßá ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡ßá ‡¶´‡ßç‡¶∞‡¶ø ‡¶°‡ßá‡¶≤‡¶ø‡¶≠‡¶æ‡¶∞‡¶ø
</div>

<button class="place-order-btn" id="placeOrderBtn" onclick="placeOrder()">
<i class="fas fa-lock"></i> ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® - <span id="btnTotal">‡ß≥0</span>
</button>

<!-- WhatsApp Order Button (Place Order ‡¶¨‡¶æ‡¶ü‡¶®‡ßá‡¶∞ ‡¶®‡¶ø‡¶ö‡ßá) -->
<button class="whatsapp-btn" onclick="orderViaWhatsApp()">
    <i class="fab fa-whatsapp"></i> WhatsApp ‡¶è ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®
</button>

<div class="security-badges">
<div style="text-align: center;">
<i class="fas fa-shield-alt"></i>
<span>‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶ö‡ßá‡¶ï‡¶Ü‡¶â‡¶ü</span>
</div>
<div style="text-align: center;">
<i class="fas fa-undo"></i>
<span>7 ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶®</span>
</div>
</div>
</div>
</div>

<!-- Success Modal -->
<div class="modal" id="successModal">
<div class="modal-content">
<div class="modal-icon">
<i class="fas fa-check"></i>
</div>
<h3>üéâ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!</h3>
<p>LiponShop ‡¶è ‡¶ï‡ßá‡¶®‡¶æ‡¶ï‡¶æ‡¶ü‡¶æ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ß‡¶®‡ßç‡¶Ø‡¶¨‡¶æ‡¶¶</p>
<div class="order-id">
‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø: <span id="modalOrderId">#ORD-XXXX</span>
</div>
<p style="font-size:13px;">
<i class="fas fa-info-circle"></i>
‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∂‡ßÄ‡¶ò‡ßç‡¶∞‡¶á ‡¶ï‡¶≤ ‡¶ï‡¶∞‡¶¨‡•§
</p>
<p style="font-size:13px;">
<i class="fas fa-sms"></i>
SMS/WhatsApp ‡¶è ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§
</p>
<button class="modal-btn" onclick="goToHome()">‡¶ï‡ßá‡¶®‡¶æ‡¶ï‡¶æ‡¶ü‡¶æ ‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶®</button>
<button class="modal-btn" onclick="trackOrder()" style="background: var(--secondary); margin-top: 10px;">
<i class="fas fa-truck"></i> ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®
</button>
</div>
</div>

<script src="js/products.js"></script>
<script src="js/cart.js"></script>
<script src="js/locations.js"></script>
<script>
    /* ==============================
   WISHLIST FUNCTIONS (index.html)
   ============================== */
function toggleWishlist(productId) {
    let wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    const index = wishlist.indexOf(productId);
    if (index === -1) {
        wishlist.push(productId);
        alert('‚úÖ Wishlist ‡¶è ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
    } else {
        wishlist.splice(index, 1);
        alert('‚ùå Wishlist ‡¶•‡ßá‡¶ï‡ßá ‡¶∏‡¶∞‡¶æ‡¶®‡ßã ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá!');
    }
    localStorage.setItem('wishlist', JSON.stringify(wishlist));
    updateWishlistCount();
    // Re-render products to update heart icon color
    if(typeof renderProducts === 'function') renderProducts();
}

function updateWishlistCount() {
    const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    const countEl = document.getElementById('wishlistCount');
    if(countEl) countEl.textContent = wishlist.length;
}

function openWishlistModal() {
    const modal = document.getElementById('wishlistModal');
    const container = document.getElementById('wishlistItems');
    const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    const products = JSON.parse(localStorage.getItem('products')) || [];
    
    container.innerHTML = '';
    if (wishlist.length === 0) {
        container.innerHTML = '<p>Wishlist ‡¶ñ‡¶æ‡¶≤‡¶ø!</p>';
    } else {
        wishlist.forEach(id => {
            const product = products.find(p => p.id === id);
            if (product) {
                container.innerHTML += `
                    <div style="display:flex; gap:10px; margin-bottom:10px; border-bottom:1px solid #eee; padding-bottom:10px;">
                        <img src="${product.img}" style="width:50px; height:50px; object-fit:cover;">
                        <div style="flex:1; text-align:left;">
                            <p style="font-weight:600;">${product.name}</p>
                            <p style="color:var(--primary);">‡ß≥${product.price}</p>
                        </div>
                        <button onclick="addToCart(${product.id}); toggleWishlist(${product.id}); closeWishlistModal();" 
                                style="background:var(--primary); color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer;">
                            Cart ‡¶è ‡¶®‡¶ø‡¶®
                        </button>
                    </div>
                `;
            }
        });
    }
    modal.style.display = 'block';
}

function closeWishlistModal() {
    document.getElementById('wishlistModal').style.display = 'none';
}

/* ==============================
   PD GUIDE FUNCTIONS (index.html)
   ============================== */
function openPdModal() {
    document.getElementById('pdModal').style.display = 'block';
}
function closePdModal() {
    document.getElementById('pdModal').style.display = 'none';
}

/* ==============================
   WHATSAPP ORDER FUNCTIONS (checkout.html)
   ============================== */
function orderViaWhatsApp() {
    // Form Values
    const name = document.getElementById('custName').value.trim();
    const phone = document.getElementById('custPhone').value.trim();
    const address = document.getElementById('custAddress').value.trim();
    const district = document.getElementById('custDistrict').value;
    
    if (!name || !phone || !address) {
        alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ‡¶Æ, ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®!');
        return;
    }

    // Cart Items
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const products = JSON.parse(localStorage.getItem('products')) || [];
    let message = `‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡ßã LiponShop! ‡¶Ü‡¶Æ‡¶ø ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶á:\n\nüë§ ‡¶®‡¶æ‡¶Æ: ${name}\nüì± ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤: ${phone}\nüìç ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ: ${address}, ${district}\n\nüõí ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞:\n`;

    cart.forEach(item => {
        const product = products.find(p => p.id === item.id);
        message += `- ${product.name} √ó ${item.quantity} (‡ß≥${product.price})\n`;
    });

    const total = document.getElementById('summaryTotal').innerText;
    message += `\nüí∞ ‡¶Æ‡ßã‡¶ü: ${total}\n\n‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞‡¶ü‡¶ø ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`;

    // Your WhatsApp Number
    const whatsappNumber = "8801748048267"; 
    const url = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
    window.open(url, '_blank');
}

// Initialize Wishlist Count on Load
document.addEventListener('DOMContentLoaded', () => {
    updateWishlistCount();
});
// ==============================
// GLOBAL VARIABLES
// ==============================
let selectedFrameSize = '';
let selectedLensType = '';
let addonTotal = 0;
let discountTotal = 0;
let deliveryCharge = 60;

// ==============================
// CHECKOUT LOGIC
// ==============================
document.addEventListener('DOMContentLoaded', () => {
const cart = JSON.parse(localStorage.getItem('cart')) || [];
if (cart.length === 0) {
window.location.href = 'cart.html';
return;
}
loadCheckoutItems();
checkEyeglassProducts();
updateSummary();
setupPaymentHandlers();
});

// Toggle Guest Checkout
function toggleGuestCheckout() {
const isGuest = document.getElementById('guestCheckout').checked;
const emailField = document.getElementById('custEmail');
if (isGuest) {
emailField.required = false;
emailField.placeholder = '‡¶ê‡¶ö‡ßç‡¶õ‡¶ø‡¶ï (‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)';
} else {
emailField.required = true;
emailField.placeholder = 'your@email.com';
}
}

// Check if cart has eyeglass products
function checkEyeglassProducts() {
const cart = JSON.parse(localStorage.getItem('cart')) || [];
const products = JSON.parse(localStorage.getItem('products')) || [];
const hasEyeglass = cart.some(item => {
const product = products.find(p => p.id === item.id);
return product && (product.category === 'Sunglass' || product.category === 'Frame');
});
if (hasEyeglass) {
document.getElementById('eyeglassSection').style.display = 'block';
}
}

// Load Checkout Items
function loadCheckoutItems() {
const container = document.getElementById('checkoutItems');
const cart = JSON.parse(localStorage.getItem('cart')) || [];
const products = JSON.parse(localStorage.getItem('products')) || [];
container.innerHTML = '';
cart.forEach(item => {
const product = products.find(p => p.id === item.id) || item;
const div = document.createElement('div');
div.className = 'cart-item';
div.innerHTML = `
<img src="${product.img}" alt="${product.name}" onerror="this.src='https://via.placeholder.com/60?text=No+Img'">
<div class="cart-item-info">
<p class="cart-item-name">${product.name}</p>
<p class="cart-item-price">‡ß≥${product.price} √ó ${item.quantity}</p>
<p class="cart-item-qty">‡¶∏‡¶æ‡¶¨‡¶ü‡ßã‡¶ü‡¶æ‡¶≤: ‡ß≥${product.price * item.quantity}</p>
</div>
`;
container.appendChild(div);
});
}

// Update Delivery Charge
function updateDeliveryCharge() {
const deliveryType = document.querySelector('input[name="delivery"]:checked').value;
deliveryCharge = deliveryType === 'express' ? 110 : 60;

// Update UI
document.querySelectorAll('.delivery-option').forEach(opt => {
opt.classList.remove('selected');
});
document.querySelector(`input[name="delivery"][value="${deliveryType}"]`).closest('.delivery-option').classList.add('selected');

updateSummary();
}

// Apply Coupon Code
function applyCoupon() {
const couponCode = document.getElementById('couponCode').value.trim().toUpperCase();
const messageEl = document.getElementById('couponMessage');

// Valid coupon codes
const validCoupons = {
'LIPON20': 20,
'LIPON10': 10,
'WELCOME15': 15,
'NEWUSER25': 25
};

if (validCoupons[couponCode]) {
const subtotal = calculateSubtotal();
discountTotal = (subtotal * validCoupons[couponCode]) / 100;
messageEl.textContent = `‚úÖ ${couponCode} ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ó ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ${validCoupons[couponCode]}% ‡¶°‡¶ø‡¶∏‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü`;
messageEl.className = 'coupon-message success';
document.getElementById('discountRow').style.display = 'flex';
updateSummary();
} else {
discountTotal = 0;
messageEl.textContent = '‚ùå ‡¶Ö‡¶¨‡ßà‡¶ß ‡¶ï‡ßÅ‡¶™‡¶® ‡¶ï‡ßã‡¶°';
messageEl.className = 'coupon-message error';
document.getElementById('discountRow').style.display = 'none';
updateSummary();
}
}

// Handle Prescription Upload
function handlePrescriptionUpload() {
const fileInput = document.getElementById('prescriptionFile');
const file = fileInput.files[0];
if (file) {
if (file.size > 5 * 1024 * 1024) {
alert('‡¶´‡¶æ‡¶á‡¶≤ ‡¶∏‡¶æ‡¶á‡¶ú 5MB ‡¶è‡¶∞ ‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ!');
fileInput.value = '';
return;
}
// In production, upload to server here
console.log('Prescription uploaded:', file.name);
}
}

// Select Frame Size
function selectFrameSize(size, element) {
selectedFrameSize = size;
document.querySelectorAll('.size-option').forEach(opt => opt.classList.remove('selected'));
element.classList.add('selected');
}

// Select Lens Type
function selectLensType(type, element) {
selectedLensType = type;
document.querySelectorAll('.lens-option').forEach(opt => opt.classList.remove('selected'));
element.classList.add('selected');
}

// Update Addons
function updateAddons() {
const addons = document.querySelectorAll('.addon-option input:checked');
addonTotal = 0;
addons.forEach(addon => {
switch(addon.value) {
case 'anti-glare': addonTotal += 200; break;
case 'blue-cut': addonTotal += 300; break;
case 'photochromic': addonTotal += 500; break;
case 'scratch-resistant': addonTotal += 150; break;
}
});
document.getElementById('addonRow').style.display = addonTotal > 0 ? 'flex' : 'none';
updateSummary();
}

// Calculate Subtotal
function calculateSubtotal() {
const cart = JSON.parse(localStorage.getItem('cart')) || [];
const products = JSON.parse(localStorage.getItem('products')) || [];
return cart.reduce((sum, item) => {
const product = products.find(p => p.id === item.id);
return sum + (product?.price || 0) * item.quantity;
}, 0);
}

// Update Summary
function updateSummary() {
const subtotal = calculateSubtotal();
const district = document.getElementById('custDistrict')?.value;

// Free delivery for Gaibandha orders over 1000
if (district === '‡¶ó‡¶æ‡¶á‡¶¨‡¶æ‡¶®‡ßç‡¶ß‡¶æ' && subtotal >= 1000) {
deliveryCharge = 0;
}

const total = subtotal + deliveryCharge + addonTotal - discountTotal;

document.getElementById('summarySubtotal').innerText = '‡ß≥' + subtotal.toLocaleString('en-BD');
document.getElementById('summaryDelivery').innerText = '‡ß≥' + deliveryCharge.toLocaleString('en-BD');
document.getElementById('summaryAddons').innerText = '‡ß≥' + addonTotal.toLocaleString('en-BD');
document.getElementById('summaryDiscount').innerText = '-‡ß≥' + discountTotal.toLocaleString('en-BD');
document.getElementById('summaryTotal').innerText = total.toLocaleString('en-BD');
document.getElementById('btnTotal').innerText = '‡ß≥' + total.toLocaleString('en-BD');

return { subtotal, deliveryCharge, addonTotal, discountTotal, total };
}

// Setup Payment Handlers
function setupPaymentHandlers() {
const paymentOptions = document.querySelectorAll('.payment-option');
const paymentInputs = document.querySelectorAll('input[name="payment"]');
paymentInputs.forEach(input => {
input.addEventListener('change', function() {
paymentOptions.forEach(opt => opt.classList.remove('selected'));
this.closest('.payment-option').classList.add('selected');
document.querySelectorAll('.payment-details').forEach(el => el.classList.remove('show'));
const method = this.value;
if (method === 'bkash') {
document.getElementById('bkashDetails').classList.add('show');
}
});
});
const districtSelect = document.getElementById('custDistrict');
if (districtSelect) {
districtSelect.addEventListener('change', updateSummary);
}
}

// Place Order
function placeOrder() {
// Validation
const name = document.getElementById('custName').value.trim();
const phone = document.getElementById('custPhone').value.trim();
const address = document.getElementById('custAddress').value.trim();
const district = document.getElementById('custDistrict').value;
const thana = document.getElementById('custThana').value;
const union = document.getElementById('custUnion').value;

if (!name || !phone || !address || !district || !thana || !union) {
alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡¶Ø‡¶º‡ßã‡¶ú‡¶®‡ßÄ‡¶Ø‡¶º ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®! (*)');
return;
}

const phoneRegex = /^01[3-9][0-9]{8}$/;
if (!phoneRegex.test(phone)) {
alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¨‡ßà‡¶ß ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂‡¶ø ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¶‡¶ø‡¶® (‡¶Ø‡ßá‡¶Æ‡¶®: 01712345678)');
return;
}

// Eyeglass validation
const eyeglassSection = document.getElementById('eyeglassSection');
if (eyeglassSection.style.display === 'block') {
if (!selectedFrameSize) {
alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶´‡ßç‡¶∞‡ßá‡¶Æ ‡¶∏‡¶æ‡¶á‡¶ú ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!');
return;
}
if (!selectedLensType) {
alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶≤‡ßá‡¶®‡ßç‡¶∏ ‡¶ü‡¶æ‡¶á‡¶™ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®!');
return;
}
}

const paymentMethod = document.querySelector('input[name="payment"]:checked').value;
if (paymentMethod === 'bkash') {
const trx = document.getElementById('bkashTrx').value.trim();
if (!trx || trx.length < 10) {
alert('‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶¨‡ßà‡¶ß bKash ‡¶ü‡ßç‡¶∞‡¶æ‡¶®‡¶ú‡ßá‡¶ï‡¶∂‡¶® ‡¶Ü‡¶á‡¶°‡¶ø ‡¶¶‡¶ø‡¶®');
return;
}
}

// Disable button
const btn = document.getElementById('placeOrderBtn');
btn.disabled = true;
btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç ‡¶π‡¶ö‡ßç‡¶õ‡ßá...';

// Prepare order data
const cart = JSON.parse(localStorage.getItem('cart')) || [];
const products = JSON.parse(localStorage.getItem('products')) || [];
const orderItems = cart.map(item => {
const product = products.find(p => p.id === item.id);
return {
id: item.id,
name: product ? product.name : item.name,
price: product ? product.price : item.price,
img: product ? product.img : 'https://via.placeholder.com/200?text=No+Image',
quantity: item.quantity
};
});

const { total } = updateSummary();
const orderId = 'ORD-' + Date.now().toString().slice(-6);
const isGuest = document.getElementById('guestCheckout').checked;
const smsNotification = document.getElementById('smsNotification').checked;

const orderData = {
id: orderId,
customer: name,
customerEmail: localStorage.getItem('customerEmail') || document.getElementById('custEmail').value,
phone: phone,
address: address,
district: district,
thana: thana,
union: union,
postal: document.getElementById('custPostal').value,
payment: paymentMethod,
paymentTrx: paymentMethod === 'cod' ? null :
(paymentMethod === 'bkash' ? document.getElementById('bkashTrx').value : null),
items: orderItems,
subtotal: calculateSubtotal(),
deliveryCharge: deliveryCharge,
addonTotal: addonTotal,
discountTotal: discountTotal,
total: total,
status: 'pending',
deliveryType: document.querySelector('input[name="delivery"]:checked').value,
smsNotification: smsNotification,
isGuest: isGuest,
eyeglass: eyeglassSection.style.display === 'block' ? {
frameSize: selectedFrameSize,
lensType: selectedLensType,
prescriptionUploaded: document.getElementById('prescriptionFile').files.length > 0,
addons: Array.from(document.querySelectorAll('.addon-option input:checked')).map(cb => cb.value)
} : null,
date: new Date().toISOString(),
notes: document.getElementById('orderNotes').value,
referrer: localStorage.getItem('currentReferrer')
};

// Save order
const orders = JSON.parse(localStorage.getItem('orders')) || [];
orders.push(orderData);
localStorage.setItem('orders', JSON.stringify(orders));

// Save to guest orders if guest checkout
if (isGuest) {
const guestOrders = JSON.parse(localStorage.getItem('guestOrders')) || [];
guestOrders.push(orderData);
localStorage.setItem('guestOrders', JSON.stringify(guestOrders));
}

// Process reseller commission if exists
if (orderData.referrer) {
const currentProfit = parseFloat(localStorage.getItem('resellerProfit')) || 0;
localStorage.setItem('resellerProfit', (currentProfit + total * 0.10).toFixed(2));
}

// Send SMS/WhatsApp notification (In production, call API here)
if (smsNotification) {
console.log('Sending SMS/WhatsApp to:', phone);
// Example: sendSMS(phone, `‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶°‡¶æ‡¶∞ ${orderId} ‡¶ï‡¶®‡¶´‡¶æ‡¶∞‡ßç‡¶Æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá! ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®: liponshop.com/track/${orderId}`);
}

// Clear cart
localStorage.removeItem('cart');
localStorage.removeItem('currentReferrer');
localStorage.removeItem('refProduct');

// Show success modal
setTimeout(() => {
document.getElementById('modalOrderId').innerText = orderId;
document.getElementById('successModal').classList.add('show');
if (typeof updateCartCount === 'function') {
updateCartCount();
}
}, 1500);
}

// Track Order
function trackOrder() {
const orderId = document.getElementById('modalOrderId').innerText;
window.location.href = `track-order.html?id=${orderId}`;
}

// Go to Home
function goToHome() {
window.location.href = 'index.html';
}
</script>
</body>
</html>